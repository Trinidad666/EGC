# Intoducci√≥n

<details>
  <summary>üöÄ Explicaci√≥n de EGC</summary>
Nuestra empresa, EGC (Enterprise Global Chat), ofrece un servicio de chat especializado en diversos sectores como inform√°tica, negocios, econom√≠a, entre otros. Los usuarios registrados pueden consultar sus dudas directamente con expertos. Nuestro objetivo es brindar soluciones r√°pidas y efectivas, tanto para usuarios individuales como para peque√±as empresas.
<br>
<br>
  
Nuestra plataforma compite con otras herramientas de mensajer√≠a, como Telegram, Skype, Discord, y m√°s, especialmente en lo que respecta a la creaci√≥n de grupos y redes de usuarios. Sin embargo, en nuestra plataforma, todos los chats son privados entre los usuarios conectados, permitiendo conversaciones directas y seguras.
<br>

Al registrarse en nuestra web, los usuarios podr√°n acceder a grupos creados por especialistas en sectores como inform√°tica, negocios, econom√≠a y otros, disponibles en modalidades p√∫blicas o privadas. Adem√°s, los usuarios podr√°n crear sus propios grupos de conversaci√≥n para compartir informaci√≥n y resolver dudas con otros usuarios.
  
</details>
<br>








<details>
<summary>üé® Dise√±o de nuestra aplicaci√≥n</summary>


## Mockup

### Home:

* En la p√°gina de inicio tendr√≠amos una imagen de fondo, y en la parte superior de la pesta√±a se mostrar√≠a el logo junto a tres enlaces que dirigir√≠an a p√°ginas donde hablar√≠amos sobre nosotros, nuestra seguridad y soporte t√©cnico, as√≠ como al inicio de sesi√≥n. Adem√°s, contar√≠amos con un footer que incluir√≠a los logotipos de nuestras redes sociales.

![image](https://github.com/user-attachments/assets/7c5c27db-fa5a-4ce7-b655-c1a179c5a935)


### Sobre Nosotros:

* En la secci√≥n "Sobre nosotros", explicar√≠amos qu√© hace nuestra empresa, cu√°ndo fue creada y qu√© ventajas ofrece en comparaci√≥n con otros servicios de chat. Tambi√©n incluir√≠amos im√°genes decorativas para mejorar la presentaci√≥n.

![image](https://github.com/user-attachments/assets/4367be43-9c0b-4f62-b6b4-724a5508d5c5)


### Nuestra Seguridad:

* En la secci√≥n "Nuestra seguridad" explicaremos las medidas de seguridad que ofrecemos, sin entrar en detalles espec√≠ficos.

![image](https://github.com/user-attachments/assets/941276f0-4848-47e5-897f-c80d1c07cc01)


### Soporte T√©cnico:

* En la secci√≥n de soporte t√©cnico, los usuarios podr√≠an ingresar su correo electr√≥nico, describir el problema que tienen y hacer clic en un bot√≥n de "Enviar".

![image](https://github.com/user-attachments/assets/63f4c1c3-9c71-42d7-8b81-6e513d4a79f4)


### Chat:

* Este ser√≠a nuestro chat, con una lista a la izquierda que muestra nuestros contactos y amigos, y un buscador para encontrar a otros contactos.

![image](https://github.com/user-attachments/assets/6d88b906-7cba-4fa5-85a2-c13a1306e03a)


### Grupos:

* En el cat√°logo, el usuario podr√° buscar temarios sobre ciberseguridad utilizando el buscador, y se le mostrar√°n diferentes temarios relacionados con el tema.

![image](https://github.com/user-attachments/assets/e68bcc31-368f-4f8c-a04e-0e3e9245ff63)


### Crear Grupo:

* En "Crear cat√°logo", el usuario podr√° subir una imagen, a√±adir un t√≠tulo y un texto, y deber√° ingresar su nombre de usuario en un apartado. Al final, tendr√° un bot√≥n para crear el cat√°logo.

![image](https://github.com/user-attachments/assets/12724ed0-f878-4d0b-bd73-a0c204ee2e36)

### Registro:

* As√≠ es como se ver√≠a la secci√≥n donde se registrar√≠an nuestros usuarios. En el formulario de registro, el usuario deber√° ingresar su nombre, primer apellido, un nombre de usuario, su correo electr√≥nico, n√∫mero de tel√©fono y una contrase√±a, la cual deber√° confirmar nuevamente.

![image](https://github.com/user-attachments/assets/587a3bd2-9e8c-4737-8d00-9a2e71e7e9d7)


### Inicio Sesi√≥n:

* As√≠ es como se ver√≠a nuestro inicio de sesi√≥n. El usuario solo deber√° ingresar su correo electr√≥nico y contrase√±a.

![image](https://github.com/user-attachments/assets/37ec7c4c-e221-415c-9b8d-cca2adff63e8)

<br>

## Gamma de colores + Logo

### Nuestra gamma de colores:

![image](https://github.com/user-attachments/assets/c999e1eb-701f-43bd-8a99-e5fd0f23e867)

### Nuestro Logo:

![ECS](https://github.com/user-attachments/assets/6ba6de8e-952c-4265-9db4-ab254b4884f4)![image](https://github.com/user-attachments/assets/03bae469-1db6-44f0-bc5f-c439e731b600)


</details>
<br>










<details>
<summary>üó∫Ô∏è Nuestros esquemas</summary>
De momento este es nuestro esquema de nuestra web EGC:

![image](https://github.com/user-attachments/assets/d29a31b2-477b-47cb-b0c9-4ed494235236)

De momento este es nuestro esquema de la bbdd de EGC:

![image](https://github.com/user-attachments/assets/238fc073-fcfb-4ff9-98d6-5fb9bc589641)

</details>
<br>


<details>
<summary>üìä Nuestros Diagramas</summary>

**Diagrama de RED**

![Esquema-Red-Visual-Paradigm](https://github.com/user-attachments/assets/0e365779-b6c6-4654-9f4b-aa757ba3182c)


**Diagrama de BBDD**

![image](https://github.com/user-attachments/assets/9c0d2cf5-3e4d-4817-a4f3-1303068c33a2)

</details>
<br>





<details>
<summary>üêã Docker</summary>

# ¬øQue es el Docker?

Docker es una plataforma que permite crear, distribuir y ejecutar aplicaciones en contenedores. Un contenedor es un entorno ligero y port√°til que incluye todo lo necesario para ejecutar un software, como c√≥digo, bibliotecas y dependencias, asegurando que funcione igual en cualquier sistema. Docker facilita la gesti√≥n y escalabilidad de aplicaciones, optimizando el uso de recursos y mejorando la eficiencia en desarrollo y despliegue. Se basa en im√°genes preconfiguradas y permite automatizar procesos, haci√©ndolo ideal para entornos de desarrollo, pruebas y producci√≥n en la nube o servidores locales.

![image](https://github.com/user-attachments/assets/c191ed6f-5e29-40d3-87d6-49e7c332e7da)



# Que ventajas y descentajas da el Docker


## Ventajas‚úÖ

¬∑ **Portabilidad de contenedores**: Los contenedores funcionan igual en cualquier sistema con Docker instalado.

¬∑ **Eficiencia**: Consume menos recursos que las m√°quinas virtuales porque comparte el sistema operativo.

¬∑ **Escalabilidad**: Facilita la gesti√≥n y despliegue de m√∫ltiples instancias de aplicaciones.

¬∑ **R√°pido despliegue**: Permite automatizar e implementar aplicaciones en segundos.

¬∑ **Aislamiento**: Evita conflictos entre dependencias de diferentes aplicaciones.



## Desventajas‚ùå

¬∑ **Rendimiento**: Puede ser menos eficiente que una ejecuci√≥n nativa.

¬∑ **Persistencia de datos**: Manejo de almacenamiento m√°s complejo.

¬∑ **Seguridad**: Comparte el kernel del host, lo que puede generar vulnerabilidades.



  
# Introducci√≥n a la instalaci√≥n de la web

Guardamos el contenido de la p√°gina web en una carpeta llamada web y la comprimimos en un archivo zip. Luego, la exportaremos a la m√°quina Alpine desde cmd utilizando el siguiente comando:

![image](https://github.com/user-attachments/assets/12bb95df-3edd-4466-9dd6-deb9006288c3)


Para descomprimir la carpeta que hemos exportado, utilizaremos el comando unzip. Luego, creamos una carpeta llamada **rbooks** donde almacenaremos la carpeta web que hemos descomprimido. Ser√° necesario mover la carpeta web dentro de la carpeta **rbooks**.


Accedemos a la carpeta **rbooks** y creamos las siguientes subcarpetas que mostraremos a continuaci√≥n:

![image](https://github.com/user-attachments/assets/8321eee2-4f73-4e67-9cb4-78866dbcaa43)


Dentro de la carpeta **nginx**, creamos un archivo llamado **default.conf** y le a√±adimos el siguiente c√≥digo:

![image](https://github.com/user-attachments/assets/90ee82b1-20dc-441f-b3be-433fbe1ac5a4)


Una vez hecho esto, salimos de la carpeta **nginx** y, dentro de **rbooks**, creamos un nuevo archivo llamado **docker-compose.yml**. A continuaci√≥n, en el archivo **docker-compose.yml**, aseguramos que el servicio **phpfpm** utilice el *Dockerfile* para construir la imagen personalizada. En lugar de usar la imagen **php:8-fpm-alpine** directamente, debemos indicar que se debe construir la imagen utilizando el *Dockerfile*.

```
services:
  # PHP service
  phpfpm:
    build:
      context: .
      dockerfile: Dockerfile   # Usa el Dockerfile personalizado
    container_name: phpfpm
    working_dir: /var/www/rbooks
    ports:
      - "9000:9000"
    volumes:
      - './web:/var/www/rbooks'
    environment:
      PHP_INI_DIR: /usr/local/etc/php
    restart: always
    networks:
      - netweb

  # Nginx service
  nginx:
    image: nginx:alpine
    container_name: nginx
    ports:
      - "8082:80"
    working_dir: /etc/nginx
    volumes:
      - './web:/var/www/rbooks'
      - './nginx/default.conf:/etc/nginx/conf.d/default.conf'
      - './nginx/:/var/log/nginx/'
    restart: always
    networks:
      - netweb

  # MySQL database service
  db:
    image: mysql
    container_name: miDB
    ports:
      - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: 1234
    volumes:
      - './mysql:/var/lib/mysql'
      - './sql:/db'
    networks:
      - netweb

  # PHPMYADMIN
  phpmyadmin:
    image: phpmyadmin
    container_name: miphpmyadmin
    environment:
      PMA_ARBITRARY: 1
      PMA_HOST: db  # Conectar phpMyAdmin al contenedor "db" (MySQL)
    ports:
      - "81:80"
    networks:
      - netweb

networks:
  netweb:
    driver: bridge

```


A continuaci√≥n, crearemos el archivo **Dockerfile** y a√±adiremos el siguiente c√≥digo para que funcione:

![image](https://github.com/user-attachments/assets/fdf3e8b4-c8e5-4f59-8688-1e79b32abbb1)


Este comando permite forzar la recreaci√≥n de los contenedores en el **docker**.

![image](https://github.com/user-attachments/assets/152d72fb-a268-4556-888d-92b322e7e909)


Si accedemos a **Portainer** y vamos a la secci√≥n de **Contenedores**, podemos ver que se ha creado de forma correcta.

![image](https://github.com/user-attachments/assets/8b4ad89a-204d-4f24-87a1-d69f03bb1b1a)








Si accedemos al navegador y ponemos **http://100.77.20.22:8082**, podremos ver que hemos ingresado correctamente a la p√°gina web de RBooks.

![image](https://github.com/user-attachments/assets/574a6d8b-f4c5-4d1b-94d8-e1fc120731d3)


Ahora, debemos cargar la base de datos en **phpMyAdmin** para que las tablas se muestren correctamente y los registros funcionen en la p√°gina web. Para ello, accedemos a **http://100.77.20.22:81** en el navegador.
* Servidor --> miDB
* Usuario --> root
* Contrase√±a --> 1234
 
![image](https://github.com/user-attachments/assets/c53a9069-f0ab-4231-a811-68cecc4c103c)


Creamos la base de datos con el nombre **rbooks**.

![image](https://github.com/user-attachments/assets/04b92b6c-414e-4112-bf8d-d7967d416278)


Para poder importar el archivo **sql** en **phpMyAdmin**, debemos ingresar en la base de datos **rbooks**, hacer clic en *Importar*, seleccionar el archivo **bbdd-rbooks.sql** y luego hacer clic en el bot√≥n *Importar*.

![image](https://github.com/user-attachments/assets/2c2f841b-84cb-4e38-a4b2-d93207c67853)


A continuaci√≥n, accedemos al archivo **conexion_be.php**, que se encuentra en la ruta ***web/php_in-sing/conexion_be.php***, y modificamos la direcci√≥n de la base de datos para establecer la conexi√≥n entre la p√°gina web y la base de datos.

![image](https://github.com/user-attachments/assets/89863329-095d-4ba2-a6ff-69adf2947224)

<br>
<br>
<br>

# Las mejoras que hemos a√±adido

Estos son los comandos que le hemos puesto en el archivo **docker-compose.yml**.

<br>
<br>

## context: .

‚Ä¢	Define el directorio base donde Docker buscar√° los archivos necesarios para construir la imagen.

‚Ä¢	En este caso, el **.** (punto) indica que el contexto de construcci√≥n es el directorio donde se encuentra el archivo docker-compose.yml.


## dockerfile: Dockerfile

‚Ä¢	Indica al Docker qu√© archivo usar para construir la imagen. En este caso, se usar√° el Dockerfile que est√° en el contexto definido arriba (.).

‚Ä¢	Permite personalizar la imagen en lugar de usar una predefinida.



## PHP_INI_DIR: /usr/local/etc/php

Define la variable de entorno PHP_INI_DIR, que indica la ubicaci√≥n del archivo de configuraci√≥n de PHP (php.ini) dentro del contenedor.

<br>
<br>

## Dockerfile Vs docker-compose
![image](https://github.com/user-attachments/assets/7dbc6d20-f0fb-4d98-9a43-3b748478d106)



## Dockerfile

### 1Ô∏è‚É£ FROM php:8-fpm-alpine

```
FROM php:8-fpm-alpine
```

Define la imagen base como php:8-fpm-alpine.



### 2Ô∏è‚É£ Instalaci√≥n de dependencias y extensiones

```
RUN apk add --no-cache libpng-dev libjpeg-turbo-dev libwebp-dev \
    && docker-php-ext-install mysqli pdo pdo_mysql
```

Usa apk add --no-cache para instalar dependencias en Alpine Linux:

‚Ä¢	libpng-dev, libjpeg-turbo-dev, libwebp-dev: Bibliotecas necesarias para manipulaci√≥n de im√°genes en PHP.


Luego, instala extensiones de PHP con docker-php-ext-install:

‚Ä¢	mysqli: Extensi√≥n para conectarse a bases de datos MySQL.

‚Ä¢	pdo y pdo_mysql: Permiten usar PDO (PHP Data Objects) con MySQL.




### 3Ô∏è‚É£ (Opcional) Ajustar php.ini para habilitar mysqli

```
# RUN echo "extension=mysqli.so" >> /usr/local/etc/php/conf.d/docker-php-ext-mysqli.ini
```

Agrega manualmente la l√≠nea **extension=mysqli.so** al archivo de configuraci√≥n de PHP. Se usar√° cuando PHP no detecta autom√°ticamente la extensi√≥n mysqli.


üîπ ¬øCu√°ndo usarlo?

Si mysqli no se activa correctamente despu√©s de instalarlo con docker-php-ext-install para asegurar de que PHP cargue la extensi√≥n en cada inicio.







</details>
<br>








<details>
<summary>‚öôÔ∏è Funcionalidades</summary>
Funcionalidades que vamos a implementar:

- Funcionalidades de Registro e inicio de sesi√≥n.(V√≠ctor)
- Que los usuarios puedan tener contactos o conversaci√≥n con t√©cnicos inform√°ticos.(Hugo)
- Los usuarios pueden crear una tabla de t√©cnicos inform√°ticos. (V√≠ctor)


Seguridad (en funci√≥n de vuestro proyecto):

- MySQL (crear m√°s de un usuario, securizar la DB, triggers)
- Protecci√≥n de c√≥digo fuente
- toda la parte de monitorizaci√≥n y seguridad que vais a implementar
</details>
<br>



<details>
<summary>üñ•Ô∏è Arquitectura del Sistema</summary>
Estos seran los componentes de tecnolog√≠a que utilizaremos en el sistema:
  
- NGINX:
  
  Servidor web y proxy inverso, muy eficiente en gestionar tr√°fico y carga.

  
- No MySQL:

  Base de datos relacional para almacenar y gestionar datos.

  
- PHP / HTML / CSS / JS:
  - PHP:

    Lenguaje de programaci√≥n del lado del servidor.

    
  - HTML:

    Lenguaje para estructurar contenido web.

    
  - CSS:

    Estilos y dise√±o web.

    
  - JS:
  
    Lenguaje para interactividad en el navegador.

    
    
- Bind9:

  Servidor DNS que resuelve nombres de dominio a direcciones IP.

  
- Docker:

  Plataforma para crear y gestionar contenedores de aplicaciones.

  
- jabberd:

  Servidor de mensajer√≠a instant√°nea basado en XMPP.
  
  
- Composer:

  Herramienta para gestionar dependencias en PHP.
  
  
- WebSocket:

  Protocolo para comunicaci√≥n en tiempo real entre cliente y servidor.
  
  
- IPTables:

  Firewall en Linux para controlar el tr√°fico de red.
  

</details>
<br>




<details>
<summary>üêß Sistemas Operativos</summary>

Estos son los Sistemas Operativos que vamos a implementar en la Maquina virtuales.


- Ubuntu Server
  
- Alpine (Docker)

- Firewall


  
</details>
<br>




<details>
<summary>üî≤ Hardware</summary>

Todas las VM tienen la misma capacidad de memoria RAM, CPU y disco duro, menos la VM Docker.

MV:
- RAM --> 2 GB
- CPU --> 1 (1 socket & 1 cores)
- HD --> 14 GB
<br>

MV Docker:
- RAM --> 4 GB
- CPU --> 4 (2 sockets & 2 cores)
- HD --> 60 GB

  
</details>
<br>



<details>
<summary>üìÑüõ°Ô∏è Backup (Copias de Segiridad)</summary>

**https://www.incibe.es/sites/default/files/contenidos/guias/guia-copias-de-seguridad.pdf**
  
# ¬øQu√© es una copia de seguridad y que importancia tiene?

Una copia de seguridad es un proceso que permite duplicar y almacenar informaci√≥n con el fin de recuperarla en caso de p√©rdida o fallo del sistema. En el √°mbito empresarial, resulta fundamental para garantizar la continuidad del negocio y mantener la confianza de los clientes. Forma parte de los planes de seguridad y contingencia, asegurando la protecci√≥n, disponibilidad y recuperaci√≥n de los datos de manera eficiente y peri√≥dica.

Imagina que tienes un cuaderno en el que anotas informaci√≥n crucial para tu escuela. Si lo pierdes o se da√±a, toda esa informaci√≥n desaparecer√≠a, lo que ser√≠a un gran problema. Lo mismo ocurre con los datos de un negocio: si no se cuenta con una copia de seguridad, cualquier fallo, error humano o ciberataque podr√≠a ocasionar la p√©rdida definitiva de informaci√≥n valiosa.
Por ello, realizar copias de seguridad regularmente es esencial. Es como tener una segunda versi√≥n de tu cuaderno guardada en un lugar seguro, lista para ser utilizada en caso de emergencia, evitando as√≠ p√©rdidas irreparables y garantizando la estabilidad de la informaci√≥n.


# ¬øQu√© copias de seguridad hariamosa?
Para definir qu√© informaci√≥n debe incluirse en las copias de seguridad, primero es necesario realizar un inventario de activos y clasificar los datos seg√∫n su importancia para el negocio. Esta clasificaci√≥n nos permitir√° priorizar la protecci√≥n de la informaci√≥n cr√≠tica y definir estrategias adecuadas de respaldo:

* Confidencialidad: (confidencial, interna, p√∫blica).

* Utilidad: (clientes, ventas, personal).

* Impacto: (da√±o de imagen, consecuencias legales, econ√≥micas, paralizaci√≥n de la actividad).

Esto ayuda a establecer medidas de seguridad y decidir qu√© informaci√≥n proteger, como datos de clientes, ventas o personal, y su frecuencia de respaldo.


# ¬øQu√© estrategias seguir√≠amos?
Para garantizar la seguridad y disponibilidad de nuestros datos, aplicaremos la estrategia 3-2-1 de copias de seguridad, una de las mejores pr√°cticas en la gesti√≥n de respaldos. Su objetivo es diversificar el almacenamiento de las copias para minimizar el riesgo de p√©rdida de informaci√≥n y asegurar la posibilidad de recuperaci√≥n en caso de fallo. Sus principios clave son:

* 3 copias: Mantener tres versiones de cada archivo importante: el original y al menos dos copias de respaldo.
* 2 soportes diferentes: Almacenar las copias en al menos dos tipos de medios distintos (por ejemplo, un disco duro externo y almacenamiento en la nube) para mitigar riesgos como fallos mec√°nicos o corrupci√≥n de datos.
* 1 copia fuera de la empresa: Guardar al menos una copia en una ubicaci√≥n externa (como un servicio de almacenamiento en la nube) para proteger la informaci√≥n ante desastres f√≠sicos, robos o ciberataques en la infraestructura local.

Ejemplo pr√°ctico
Si trabajamos con un archivo cr√≠tico llamado "listadoproveedores.ots", podr√≠amos aplicar la estrategia 3-2-1 de la siguiente manera:

* Archivo original: Se almacena en el equipo principal donde se trabaja con √©l.
* Primera copia de seguridad: Se guarda en un disco duro externo o servidor NAS local.
* Segunda copia de seguridad: Se sube a un servicio de almacenamiento en la nube (cumpliendo tambi√©n con la regla de "ubicaci√≥n externa").


# ¬øD√≥nde se van a ubicar las copias?

Por el momento, almacenaremos nuestras copias de seguridad en Google Drive y en discos duros externos como medida preventiva ante cualquier incidente inesperado, garantizando que siempre tengamos acceso a nuestros datos en caso de fallos o imprevistos.

Adem√°s, hemos decidido implementar un sistema de almacenamiento en la nube para reforzar a√∫n m√°s la seguridad y disponibilidad de la informaci√≥n. Actualmente, estamos en proceso de evaluaci√≥n y configuraci√≥n de este servicio, asegur√°ndonos de elegir la mejor opci√≥n en t√©rminos de fiabilidad, cifrado y accesibilidad.

Tambi√©n crearemos una m√°quina virtual en Proxmox que funcionar√° como servidor central para almacenar toda la informaci√≥n, bases de datos y c√≥digo fuente de nuestro proyecto. Adem√°s, configuraremos copias de seguridad automatizadas y medidas de seguridad como firewalls y cifrado para garantizar la integridad y protecci√≥n de los datos.


# Esto sera la informaci√≥n que copiaremos para asegurar nuestro proyecto:

* Base de Datos: La informaci√≥n de los usuarios y datos cr√≠ticos de la empresa deben resguardarse con la mayor frecuencia posible. Un respaldo frecuente y seguro es clave para evitar p√©rdidas de informaci√≥n valiosa.

* DNS: El DNS es fundamental para el funcionamiento de los servicios en l√≠nea, asegurando que los dominios est√©n correctamente direccionados. Un backup del DNS garantiza que la infraestructura web siga operativa en caso de fallos.

* C√≥digo de la Web y Nginx: Resguardar el c√≥digo fuente de la web junto con la configuraci√≥n de Nginx es esencial para una r√°pida recuperaci√≥n en caso de incidentes o ataques.

* Router: Mantener una copia de seguridad de la configuraci√≥n del router es crucial para garantizar la conectividad de la red y facilitar su restauraci√≥n en caso de fallas o modificaciones accidentales.



# C√≥digos del Backup
## Copias de seguridad
Hemos creado este script en Bash para automatizar el proceso de realizar una copia de seguridad cifrada de una carpeta en un sistema local y transferirla de forma segura a un servidor remoto. A continuaci√≥n, os mostraremos que hace cada parte del c√≥digo:

1. Creaci√≥n de carpetas de log si no existe.
2. Redirigir salida est√°ndar y errores al archivo de log.
3. Verificar conexi√≥n SSH con el destino.
4. Verificar si la carpeta de origen existe.
5. Crear carpeta temporal para los archivos cifrados.
6. Cifrar archivos manteniendo la estructura original.
7. Crear carpeta destino en el servidor remoto si no existe.
8. Enviar archivos cifrados al servidor remoto.
9. Limpiar archivos temporales.
10. Instrucciones para descifrar el destino.

```
#!/bin/bash

# Configuraci√≥n
USUARIO_DESTINO="hugo"
IP_DESTINO="192.168.6.10"
CARPETA_ORIGEN="/home/hugo/buckup/origen"
CARPETA_DESTINO="/home/hugo/destino"
CARPETA_TEMP="/tmp/backup_encrypt"
SCRIPT_DIR="$(dirname "$(realpath "$0")")"  # Obtiene la ruta del script
LOG_DIR="$SCRIPT_DIR/logs"
TIMESTAMP="$(date '+%H.%M_%d-%m-%Y')"  # Formato de fecha y hora
LOG_FILE="$LOG_DIR/backup_$TIMESTAMP.log"
CLAVE_CIFRADO="alumno"

# Crear carpeta de logs si no existe
mkdir -p "$LOG_DIR"

# Redirigir salida est√°ndar y errores al archivo de log
exec >> "$LOG_FILE" 2>&1

echo "[$(date)] - Iniciando respaldo con cifrado..."

# Verificar conexi√≥n SSH con el destino
if ! nc -z "$IP_DESTINO" 22; then
    echo "[$(date)] - Error: No se puede conectar a $IP_DESTINO en el puerto 22."
    exit 1
fi

# Verificar si la carpeta de origen existe
if [ ! -d "$CARPETA_ORIGEN" ]; then
    echo "[$(date)] - Error: La carpeta de origen no existe: $CARPETA_ORIGEN"
    exit 1
fi

# Crear carpeta temporal para los archivos cifrados
mkdir -p "$CARPETA_TEMP"

# Cifrar archivos manteniendo la estructura original
echo "[$(date)] - Cifrando archivos..."
tar -czf - -C "$(dirname "$CARPETA_ORIGEN")" "$(basename "$CARPETA_ORIGEN")" | \
gpg --symmetric --cipher-algo AES256 --passphrase "$CLAVE_CIFRADO" --batch -o "$CARPETA_TEMP/backup.tar.gz.gpg"

# Crear carpeta destino en el servidor remoto si no existe
ssh "$USUARIO_DESTINO@$IP_DESTINO" "mkdir -p $CARPETA_DESTINO"

# Enviar archivos cifrados al servidor remoto
echo "[$(date)] - Enviando archivos cifrados..."
if rsync -avz -e "ssh -p 22" "$CARPETA_TEMP/backup.tar.gz.gpg" "$USUARIO_DESTINO@$IP_DESTINO:$CARPETA_DESTINO/"; then
    echo "[$(date)] - Respaldo cifrado enviado con √©xito."
else
    echo "[$(date)] - Error: Fallo en la sincronizaci√≥n con rsync."
    exit 1
fi

# Limpiar archivos temporales
rm -rf "$CARPETA_TEMP"

# Instrucciones para descifrar en el destino
echo "[$(date)] - Para descifrar en el servidor destino, ejecutar:"
echo "  gpg --decrypt --passphrase \"$CLAVE_CIFRADO\" --batch $CARPETA_DESTINO/backup.tar.gz.gpg | tar -xz -C $CARPETA_DESTINO"

echo "[$(date)] - Respaldo finalizado."
```

<br>


## Recuperaci√≥n de las copias de seguridad
Hemos creado este script para recuperar copias de seguridad cifradas desde un servidor remoto y restaurarlas en una carpeta local. A continuaci√≥n, se describe brevemente c√≥mo funciona.

1. Crear carpeta de logs si no existe.
2. Redirigir salida est√°ndar y errores al archivo de log.
3. Verificar conexi√≥n SSH con el servidor.
4. Verificar si la carpeta de destino existe en el servidor remoto.
5. Crear carpeta de recuperaci√≥n si no existe.
6. Descargar copias desde el servidor remoto.
7. Descrifrar los archivos descargados.

```
#!/bin/bash

# Configuraci√≥n
USUARIO_DESTINO="hugo"
IP_DESTINO="192.168.6.10"
CARPETA_DESTINO="/home/hugo/destino"
CARPETA_RECUPERACION="/home/hugo/buckup/recuperacion_copias"
CLAVE_CIFRADO="alumno"  # La clave para descifrar
SCRIPT_DIR="$(dirname "$(realpath "$0")")"  # Ubicaci√≥n del script
LOG_DIR="$SCRIPT_DIR/log_recuperacion"  # Nueva carpeta de logs
TIMESTAMP="$(date '+%H.%M_%d-%m-%Y')"
LOG_FILE="$LOG_DIR/recuperacion_$TIMESTAMP.log"

# Crear carpeta de logs si no existe
mkdir -p "$LOG_DIR"

# Redirigir salida est√°ndar y errores al archivo de log
exec >> "$LOG_FILE" 2>&1

echo "[$(date)] - Iniciando recuperaci√≥n de backups..."
echo "[$(date)] - El script se est√° ejecutando desde: $SCRIPT_DIR"

# Verificar conexi√≥n SSH con el servidor
echo "[$(date)] - Comprobando conexi√≥n SSH..."
if ! ssh -q -o ConnectTimeout=5 "$USUARIO_DESTINO@$IP_DESTINO" exit; then
    echo "[$(date)] - Error: No se puede conectar a $IP_DESTINO mediante SSH."
    exit 1
fi

# Verificar si la carpeta de destino existe en el servidor remoto
echo "[$(date)] - Verificando existencia de $CARPETA_DESTINO en el servidor..."
if ! ssh "$USUARIO_DESTINO@$IP_DESTINO" "[ -d '$CARPETA_DESTINO' ]"; then
    echo "[$(date)] - Error: La carpeta destino no existe en el servidor remoto."
    exit 1
fi

# Crear carpeta de recuperaci√≥n si no existe
echo "[$(date)] - Creando carpeta de recuperaci√≥n en $CARPETA_RECUPERACION..."
if ! mkdir -p "$CARPETA_RECUPERACION"; then
    echo "[$(date)] - Error: No se pudo crear $CARPETA_RECUPERACION. Verifica permisos."
    exit 1
fi

# Descargar copias desde el servidor remoto
echo "[$(date)] - Descargando backups desde $CARPETA_DESTINO..."
if rsync -avz -e "ssh -p 22" "$USUARIO_DESTINO@$IP_DESTINO:$CARPETA_DESTINO/" "$CARPETA_RECUPERACION/"; then
    echo "[$(date)] - Backups recuperados con √©xito en $CARPETA_RECUPERACION."
else
    echo "[$(date)] - Error: Fallo en la recuperaci√≥n con rsync."
    exit 1
fi

# Descrifrar los archivos descargados
echo "[$(date)] - Desencriptando archivos..."
for archivo in "$CARPETA_RECUPERACION"/*.tar.gz.gpg; do
    if [ -f "$archivo" ]; then
        echo "[$(date)] - Desencriptando $archivo..."
        gpg --quiet --batch --yes --passphrase "$CLAVE_CIFRADO" --decrypt "$archivo" | tar -xz -C "$CARPETA_RECUPERACION"
        if [ $? -eq 0 ]; then
            echo "[$(date)] - Archivo $archivo descifrado con √©xito."
            rm -f "$archivo"  # Eliminar el archivo cifrado despu√©s del descifrado
        else
            echo "[$(date)] - Error al descifrar el archivo $archivo."
            exit 1
        fi
    else
        echo "[$(date)] - No se encontraron archivos cifrados para descifrar en $CARPETA_RECUPERACION."
    fi
done

echo "[$(date)] - Proceso de recuperaci√≥n finalizado correctamente."

```
<br>


## Autenticaci√≥n SSH sin Contrase√±a para un Script

Para evitar que el script solicite una contrase√±a al ejecutar los comandos SSH y rsync, debes configurar la autenticaci√≥n sin contrase√±a mediante claves SSH.


### Generar una clave SSH en el cliente



```
ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa -N ""

```

Esto generar√° un par de claves:

* ~/.ssh/id_rsa (clave privada)
* ~/.ssh/id_rsa.pub (clave p√∫blica)



### Copiar la clave p√∫blica al servidor destino

Usa el siguiente comando para copiar autom√°ticamente la clave p√∫blica al servidor:

```
ssh-copy-id hugo@192.168.6.10

```

Si no tienes ssh-copy-id, puedes hacerlo manualmente con:

```
cat ~/.ssh/id_rsa.pub | ssh hugo@192.168.6.10 "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"

```

### Verificar la autenticaci√≥n sin contrase√±a

Prueba iniciar sesi√≥n en el servidor sin que te pida la contrase√±a:

```
ssh hugo@192.168.6.10

```
<br>
<br>


## Recibir las copias a la carpeta destino

El comando sudo chown -R hugo:hugo /home/hugo/buckup cambia el propietario y el grupo de todos los archivos y subdirectorios dentro de /home/hugo/buckup al usuario hugo

```
sudo chown -R hugo:hugo /home/hugo/buckup

```

* sudo: Ejecuta el comando con privilegios de superusuario.

* chown: Cambia el propietario de un archivo o directorio.

* -R: Aplica el cambio de propietario de forma recursiva (a todos los archivos y subdirectorios dentro de /home/hugo/buckup).

* hugo:hugo : Establece el usuario propietario como hugo y el grupo como hugo.

* /home/hugo/buckup: Especifica la carpeta a la que se aplicar√° el cambio.

<br>


Establece permisos de lectura, escritura y ejecuci√≥n para el propietario, y solo lectura y ejecuci√≥n para el grupo y otros usuarios en los archivos dentro de /home/hugo/destino.

```
sudo chmod -R 755 /home/hugo/destino

```

* sudo: Ejecuta el comando con privilegios de superusuario.

* chmod: Modifica los permisos de archivos o directorios.

* -R: Aplica el cambio de permisos recursivamente a todos los archivos y subdirectorios dentro del directorio.

* 755: Establece los permisos de lectura, escritura y ejecuci√≥n para el propietario (7 = lectura, escritura y ejecuci√≥n), y solo lectura y ejecuci√≥n para el grupo y los otros usuarios (5 = lectura y ejecuci√≥n).

* /home/hugo/destino: Especifica la ruta del directorio al cual se le aplican los permisos.


<br>
<br>


## Recibir las copias a la carpeta de recuperaci√≥n

El comando sudo chown -R hugo:hugo /home/hugo/buckup cambia el propietario y el grupo de todos los archivos y subdirectorios dentro de /home/hugo/buckup al usuario hugo

```
sudo chown -R hugo:hugo /home/hugo/buckup

```

* sudo: Ejecuta el comando con privilegios de superusuario.

* chown: Cambia el propietario de un archivo o directorio.

* -R: Aplica el cambio de propietario de forma recursiva (a todos los archivos y subdirectorios dentro de /home/hugo/buckup).

* hugo:hugo : Establece el usuario propietario como hugo y el grupo como hugo.

* /home/hugo/buckup: Especifica la carpeta a la que se aplicar√° el cambio.

<br>
<br>


El comando sudo chmod -R u+w /home/hugo/buckup otorga permisos de escritura al usuario propietario en todos los archivos y subdirectorios dentro de /home/hugo/buckup, recursivamente.

```
sudo chmod -R u+w /home/hugo/buckup

```

* sudo: Ejecuta el comando con privilegios de superusuario.

* chmod: Modifica los permisos de archivos o directorios.

* -R: Aplica los cambios de permisos recursivamente.

* -u+w: Agrega permiso de escritura (+w) al usuario propietario (u).

* /home/hugo/buckup: Carpeta a la que se aplicar√° el cambio.


</details>
<br>



<details>
<summary>üß±üî• PFSense</summary>

# ¬øQu√© es PFSense?
Es una distribuci√≥n de **FreeBSD** adaptada como **firewall** y **router**. Es de c√≥digo abierto y se puede instalar en dispositivos f√≠sicos y virtuales.
Es sostenida comercialmente por **Electric Sheep Fencing LLC**, adem√°s de ser de c√≥digo abierto.
pfSense proporciona funciones avanzadas de seguridad y networking, y es conocido por ser una soluci√≥n de firewall de alto rendimiento. Ahora os mostraremos unas caracter√≠sticas que hemos encontrado.

* **Firewall avanzado:** Nos ofrece reglas de firewall que permite filtrar y controlar el tr√°fico de red de manera efectiva.
* **Enrutamiento:** Se puede utilizar como un router que nos proporciona funciones de enrutamiento avanzadas y permitiendo la conectividad entre redes.
* **VPN:** 
* **Proxy y filtrado web:** 
* **Balanceo de carga y redundancia:** 
* **Seguridad:** 
* **Interfaz gr√°fica:** 




</details>












<br><br><br>





















# Tema sobre la WEB

<details>
  <summary>üáπüá© Chat</summary>
  
  # Chat Interface Concept
  
  https://codepen.io/emilcarlsson/pen/ZOQZaV
  
  ![image](https://github.com/user-attachments/assets/15b8bdd0-554e-4116-b73e-086db5766ed0)


  # 5 –ñ–∏–≤–æ–π —á–∞—Ç / Live chat
  
  https://codepen.io/retyui/pen/zxGqPJ
  
  ![image](https://github.com/user-attachments/assets/12b26776-440e-474e-89f1-c7695ad79702)


  # Sidebar AdminLTE
  
  https://codepen.io/jasp402/pen/VrYzNw
  
  ![image](https://github.com/user-attachments/assets/bec42ba2-6cfc-4304-b220-cf128d50d4c9)


  # Material Messaging App Concept
  
  https://codepen.io/ThomasDaubenton/pen/QMqaBN
  
  ![image](https://github.com/user-attachments/assets/9b322906-8ead-4d2a-ba92-3e964af13b26)


  # Discord Mockup
  
  https://codepen.io/odensc/pen/vxpMPp
  
  ![image](https://github.com/user-attachments/assets/3d085bc8-4ab1-4b66-8061-8894e0c203a2)


</details>
<br>



<details>
  <summary>üìß Enviar email a la empresa</summary>
  
  # Responsive Contact Form
  
  https://codepen.io/wgnr/pen/ExKzNJ

  ![image](https://github.com/user-attachments/assets/5a7ec21a-ad85-4233-a0f6-54e7b55af226)


  

  ##



</details>
<br>



<details>
  <summary>üìù|‚ñ∂Ô∏è Registrar | Inicio</summary>
  
  # Responsive Registration Form
  
  https://codepen.io/anandaprojapati/pen/GmrwYE

  ![image](https://github.com/user-attachments/assets/29bfc20d-0d2a-4ef1-bdfb-7d361b2c3ae3)


  #



</details>
<br>




<details>
  <summary>üé® Dise√±os graficos</summary>
  
  # üî≤ H Y P E R H E D R O N üî≤

  https://codepen.io/shshaw/pen/eGYZOe

  ![image](https://github.com/user-attachments/assets/1455a975-41b5-4e03-9d98-42e1d57146c8)



  # canvas base typeface

  https://codepen.io/ara_node/pen/DdNQqQ

  ![image](https://github.com/user-attachments/assets/5793e444-87d7-40be-80b9-172d0b93ea7d)


  # #Anonymous Hacker Portfolio

  https://codepen.io/Breekee/pen/QWjjdOQ
  
  ![image](https://github.com/user-attachments/assets/2443b86b-ee03-4f8a-92f5-4db8135efbd1)


  # Text Glitch

  https://codepen.io/alexr4/pen/BqVbLr

  ![image](https://github.com/user-attachments/assets/567ab563-e313-4e3b-9283-8133a3e4bfb2)


  #

</details>
<br>



